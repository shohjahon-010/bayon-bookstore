<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitoblar - Bayon</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .books-page {
            padding: 2rem 0;
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 4px;
        }

        .books-count {
            margin-bottom: 1rem;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <h1>üìö Bayon</h1>
                </div>
                <button class="hamburger" id="hamburger" onclick="toggleMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="index.html">Bosh Sahifa</a></li>
                    <li><a href="books.html" class="active">Kitoblar</a></li>
                    <li><a href="about.html">Biz Haqida</a></li>
                    <li><a href="contact.html">Aloqa</a></li>
                </ul>
                <div class="cart-icon" onclick="toggleCart()">
                    <span class="cart-count" id="cartCount">0</span>
                    üõí
                </div>
            </div>
        </div>
    </nav>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h2>Savatcha</h2>
            <button class="close-btn" onclick="toggleCart()">‚úï</button>
        </div>
        <div class="cart-items" id="cartItems">
            <p class="empty-cart">Savatcha bo'sh</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <strong>Jami:</strong>
                <span id="cartTotal">0 so'm</span>
            </div>
            <button class="checkout-btn" onclick="checkout()">Sotib Olish</button>
        </div>
    </div>

    <!-- Books Page -->
    <div class="container books-page">
        <h1 style="color: var(--primary); margin-bottom: 2rem;">Barcha Kitoblar</h1>

        <div class="filters">
            <div class="filter-group">
                <label>Qidiruv</label>
                <input type="text" id="searchInput" placeholder="Kitob nomini kiriting" oninput="filterBooks()">
            </div>
           
            <div class="filter-group">
                <label>Narx Oralig'i</label>
                <select id="priceFilter" onchange="filterBooks()">
                    <option value="">Barcha Narxlar</option>
                    <option value="0-80000">0 - 80,000 so'm</option>
                    <option value="80000-120000">80,000 - 120,000 so'm</option>
                    <option value="120000-200000">120,000+ so'm</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Saralash</label>
                <select id="sortFilter" onchange="filterBooks()">
                    <option value="popular">Mashhur</option>
                    <option value="price-low">Narx: Kam ‚Üí Ko'p</option>
                    <option value="price-high">Narx: Ko'p ‚Üí Kam</option>
                    <option value="rating">Reyting</option>
                </select>
            </div>
        </div>

        <div class="books-count" id="booksCount"></div>
        <div class="books-grid" id="booksGrid"></div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Bayon Kitob Do'koni</h4>
                    <p>O'zbek adabiyoti va tarixining eng yaxshi kitoblarini taqdim etamiz</p>
                </div>
                <div class="footer-section">
                    <h4>Tezkor Havolalar</h4>
                    <ul>
                        <li><a href="index.html">Bosh Sahifa</a></li>
                        <li><a href="books.html">Kitoblar</a></li>
                        <li><a href="about.html">Biz Haqida</a></li>
                        <li><a href="contact.html">Aloqa</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Aloqa</h4>
                    <p>üìû +998 (77) 056 07 70</p>
                    <p>üìß info@bayon.uz</p>
                    <p>üìç Farg'ona, O'zbekiston</p>
                </div>
                <div class="footer-section">
                    <h4>Ijtimoiy Tarmoqlar</h4>
                    <div class="social-links">
                        <a href="#">Facebook</a>
                        <a href="#">Instagram</a>
                        <a href="#">Telegram</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Bayon Kitob Do'koni. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <!-- Falling Animation Container -->
    <div id="fallingContainer"></div>

    <script src="script.js"></script>
    <script>
        const allBooks = [
            { id: 1, name: "Har narsadan tashvish chekma ey ko‚Äònggil", author: "Ug'ur Qoshar", price: 37000, category: "Tarix", rating: 5, reviews: 245, image: "photo_2025-10-27_19-25-41.jpg" },
            { id: 2, name: "Qo‚Äòrqmanglar men sizlar bilanman", author: "Ug'ur Qoshar", price: 37000, category: "Adabiyot", rating: 5, reviews: 312, image: "photo_2025-10-27_19-25-44.jpg" },
            { id: 3, name: "Eng ishonchli vakil", author: "Ug'ur Qoshar", price: 38000, category: "Tarix", rating: 4, reviews: 189, image: "photo_2025-10-27_19-25-38.jpg" },
            { id: 4, name: "Menga Alloh kifoya", author: "Ug'ur Qoshar", price: 50000, category: "Sayohat", rating: 5, reviews: 267, image: "photo_2025-10-27_19-25-42.jpg" },
            { id: 5, name: "Saltanat tabibi", author: "Mahmud Hasaniy", price: 83000, category: "Madaniyat", rating: 4, reviews: 156, image: "photo_2025-10-27_18-29-54.jpg" },
            { id: 6, name: "Turkiston Rossiya va Xitoy oralig‚Äòida", author: "Bormirza Hayit", price: 84000, category: "Madaniyat", rating: 5, reviews: 198, image: "photo_2025-10-27_19-25-41.jpg" },
            { id: 7, name: "Ishonchli xabar", author: "Adhan Sharqoviy", price: 83000, category: "Adabiyot", rating: 5, reviews: 234, image: "photo_2025-10-27_19-25-50.jpg" },
            { id: 8, name: "Mudarris", author: "Ahmad Tohir", price: 95000, category: "Madaniyat", rating: 4, reviews: 145, image: "photo_2025-10-27_19-25-59.jpg" },
            { id: 9, name: "Madrasa", author: "Zodut Tolibiyn", price: 60000, category: "Tarix", rating: 4, reviews: 167, image: "photo_2025-10-27_19-26-02.jpg" },
            { id: 10, name: "Islomga bag'ishlangan umr", author: "Muhammad Amin Muhammad Yusuf", price: 40000, category: "Adabiyot", rating: 5, reviews: 289, image: "photo_2025-10-27_19-26-09.jpg" },
            { id: 11, name: "FALASTIN: agar o'lishim lozim bo'lsa...", author: "Nadejda Kevorkova", price: 69000, category: "Adabiyot", rating: 5, reviews: 201, image: "photo_2025-10-27_19-26-23.jpg" },
            { id: 12, name: "Halqa", author: "Akrom Malik", price: 65000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-27_19-26-27.jpg" },
            { id: 13, name: "Ilm olish sirlari", author: "Imom Zarnujiy", price: 43000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-06-36.jpg" },
            { id: 14, name: "Talabalik davrini qanday o'tkazmoq kerak?", author: "Axmad Naqshbandiy", price: 26000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-06-38.jpg" },
            { id: 15, name: "Talabaning odoblari", author: "Muhammad Ismoil", price: 33000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-06-40.jpg" },
            { id: 16, name: " Ilm olish yo'lida 13 tavsiya", author: "Muhammad Abul hoj", price: 52000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-19.jpg" },
            { id: 17, name: "At-Tibyon", author: "Nomalum", price: 52000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-37.jpg" },
            { id: 18, name: " Ilm asrida din", author: "Yusuf Qarazoviy", price: 39000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-14.jpg" },
            { id: 19, name: "Nafs taftish", author: "Atouloh Sakandariy", price: 40000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-12.jpg" },
            { id: 20, name: "Allohning borligiga moddiy dalillar", author: "Mutavalli Sha'roviy", price: 49000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-09.jpg" },
            { id: 21, name: "Viqor libosi", author: "Jobir Fayfiy", price: 43000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-06.jpg" },
            { id: 22, name: " Barzax hayoti", author: "Jalolayn", price: 27000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-04.jpg" },
            { id: 23, name: "G'azablanma", author: "Oiz Qarniy", price: 50000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-03.jpg" },
            { id: 24, name: "Ildizlarni anglash sari", author: "Ramazon Butiy", price: 40000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-59-02.jpg" },
            { id: 25, name: "Hayotingni yangila!", author: "Shayx G'azzoliy", price: 49000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_12-58-58.jpg" },
            { id: 26, name: "Daholar qanday ulg'ayadi?", author: "Erdinch G√ºll√º", price: 47000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-09-19.jpg" },
            { id: 27, name: "Ochlik", author: "Knut Hamsun", price: 69000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-09-10.jpg" },
            { id: 28, name: "Qalb doktori", author: "Yashar Kandemir", price: 52000, category: "Tarix", rating: 5, reviews: 276, image: "photo_2025-10-28_13-09-04.jpg" }
        ];

        function renderBooks(books) {
            const grid = document.getElementById('booksGrid');
            const count = document.getElementById('booksCount');

            count.textContent = `${books.length} ta kitob topildi`;

            grid.innerHTML = books.map(book => `
                <div class="book-card" onclick="addToCart(${book.id}, '${book.name}', ${book.price}, '${book.image}')">
                    <div class="book-image">
                        <img src="./image/${book.image}" alt="${book.name}">
                    </div>
                    <div class="book-info">
                        <h3>${book.name}</h3>
                        <p class="author">${book.author}</p>
                        <p class="price">${book.price.toLocaleString()} so'm</p>
                        <div class="rating">
                            ${'‚òÖ'.repeat(book.rating)}${'‚òÜ'.repeat(5-book.rating)}
                            <span class="reviews">(${book.reviews})</span>
                            <button class="add-btn">Savatga Qo'shish</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterBooks() {
            let filtered = [...allBooks];

            const searchEl = document.getElementById('searchInput');
            const search = searchEl ? searchEl.value.trim().toLowerCase() : '';

            const categoryEl = document.getElementById('categoryFilter');
            const category = categoryEl ? categoryEl.value : '';

            const priceEl = document.getElementById('priceFilter');
            const price = priceEl ? priceEl.value : '';

            const sortEl = document.getElementById('sortFilter');
            const sort = sortEl ? sortEl.value : '';

            // Search filter (name va author bo'yicha)
            if (search) {
                filtered = filtered.filter(book =>
                    (book.name + ' ' + book.author).toLowerCase().includes(search)
                );
            }

            // Category filter (agar element mavjud bo'lsa)
            if (category) {
                filtered = filtered.filter(book => book.category === category);
            }

            // Price filter
            if (price) {
                const [min, max] = price.split('-').map(Number);
                filtered = filtered.filter(book => book.price >= min && (max ? book.price <= max : true));
            }

            // Sorting
            if (sort === 'price-low') {
                filtered.sort((a, b) => a.price - b.price);
            } else if (sort === 'price-high') {
                filtered.sort((a, b) => b.price - a.price);
            } else if (sort === 'rating') {
                filtered.sort((a, b) => b.rating - a.rating || b.reviews - a.reviews);
            } else {
                filtered.sort((a, b) => b.reviews - a.reviews);
            }

            renderBooks(filtered);
        }

        // --- Qo'shilgan: savatcha uchun rasm ko'rsatuvchi funksiyalar ---
        const CART_KEY = 'bayon_cart';

        function getCart() {
            try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); }
            catch (e) { return []; }
        }
        function saveCart(cart) {
            localStorage.setItem(CART_KEY, JSON.stringify(cart));
        }

        function addToCart(id, name, price, image) {
            const cart = getCart();
            const existing = cart.find(i => i.id === id);
            if (existing) {
                existing.qty = (existing.qty || 1) + 1;
            } else {
                cart.push({ id, name, price, image, qty: 1 });
            }
            saveCart(cart);
            renderCart();
            updateCartCount();
        }

        function renderCart() {
            const container = document.getElementById('cartItems');
            const totalEl = document.getElementById('cartTotal');
            if (!container) return;

            const cart = getCart();
            if (!cart.length) {
                container.innerHTML = `<p class="empty-cart">Savatcha bo'sh</p>`;
                if (totalEl) totalEl.textContent = "0 so'm";
                return;
            }

            container.innerHTML = cart.map(item => `
                <div class="cart-item" style="display:flex;gap:0.75rem;align-items:flex-start;padding:0.5rem 0;border-bottom:1px solid var(--border);">
                    <div class="cart-item-image" style="flex:0 0 72px;">
                        <img src="./image/${item.image}" alt="${item.name}" style="width:72px;height:92px;object-fit:cover;border-radius:6px;border:1px solid var(--border)">
                    </div>
                    <div class="cart-item-info" style="flex:1;">
                        <div class="cart-item-name" style="font-weight:600;">${item.name}</div>
                        <div class="cart-item-price" style="color:rgba(0,0,0,0.7);margin:0.25rem 0;">${item.price.toLocaleString()} so'm</div>
                        <div class="cart-item-actions" style="display:flex;gap:0.5rem;align-items:center;">
                            <button class="qty-btn" onclick="changeQty(${item.id}, -1)" style="padding:0.25rem 0.5rem;border-radius:6px;border:1px solid var(--border)">-</button>
                            <span style="min-width:26px;text-align:center;display:inline-block">${item.qty}</span>
                            <button class="qty-btn" onclick="changeQty(${item.id}, 1)" style="padding:0.25rem 0.5rem;border-radius:6px;border:1px solid var(--border)">+</button>
                            <button class="remove-btn" onclick="removeFromCart(${item.id})" style="margin-left:0.5rem;color:var(--primary);background:transparent;border:none;cursor:pointer">O'chirish</button>
                        </div>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((s, i) => s + (i.price * (i.qty || 1)), 0);
            if (totalEl) totalEl.textContent = total.toLocaleString() + " so'm";
        }

        function changeQty(id, delta) {
            let cart = getCart();
            const item = cart.find(i => i.id === id);
            if (!item) return;
            item.qty = (item.qty || 1) + delta;
            if (item.qty <= 0) cart = cart.filter(i => i.id !== id);
            saveCart(cart);
            renderCart();
            updateCartCount();
        }

        function removeFromCart(id) {
            const cart = getCart().filter(i => i.id !== id);
            saveCart(cart);
            renderCart();
            updateCartCount();
        }

        function updateCartCount() {
            const countEl = document.getElementById('cartCount');
            if (!countEl) return;
            const totalQty = getCart().reduce((s, i) => s + (i.qty || 0), 0);
            countEl.textContent = totalQty;
        }

        function loadCart() {
            renderCart();
            updateCartCount();
        }

        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            if (!sidebar) return;
            sidebar.classList.toggle('active');
        }

        function checkout() {
            const cart = getCart();
            if (!cart.length) { alert("Savatcha bo'sh"); return; }
            // Bu demo: haqiqiy to'lov tizimi qo'shish kerak
            alert(`Siz ${cart.length} ta mahsulotni xarid qilmoqchisiz. (Demo)`);
        }

        // --- Oxirida: boshlang'ich render va yuklash ---
        // (agar saytingizda allBooks/renderBooks/filterBooks mavjud bo'lsa, ular avvalgi kodda ishlaydi)
        renderBooks(allBooks);
        loadCart();
    </script>
</body>
</html>
